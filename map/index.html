<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>–ö–∞—Ä—Ç–∞ –ø—É–Ω–∫—Ç–æ–≤ –ø—Ä–∏—ë–º–∞ –≤—Ç–æ—Ä—Å—ã—Ä—å—è –ú–§–¢–ò</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#c0deab">
<meta property="og:title" content="–ö–∞—Ä—Ç–∞ –ø—É–Ω–∫—Ç–æ–≤ –ø—Ä–∏—ë–º–∞ –≤—Ç–æ—Ä—Å—ã—Ä—å—è –ú–§–¢–ò">
<meta property="og:image" content="https://i.imgur.com/MbtLPHc.png">
<link rel="icon" type="image/x-icon" href="../favicon.ico">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
 integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
 crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
 integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
 crossorigin=""></script>
<style>
html {
    background: #c0deab;
    color: #030;
    text-align: center;
    font-family: sans-serif;
}
h1 {
    margin: 0.4em 0;
}
ul {
    padding-left: 20px;
}
#map-container {
    height: 500px;
    max-height: 72vh;
    max-width: 750px;
    margin: 1em auto;
    border: #7a7 0.2em solid;
}
#text-button {
    cursor: pointer;
    color: #000;
    height: 2.25em;
    vertical-align: bottom;
}
.bordered-box {
    max-width: 600px;
    margin: 0.5em auto;
    text-align: left;
    border: #7a7 0.1em solid;
    border-radius: 2em;
    background: rgba(255,255,255,0.2);
    padding: 0.8em 1.5em;
}
.marker-gray {
    filter: grayscale(1) brightness(1.5);
}
.marker-blue-gray {
    filter: grayscale(0.6) brightness(1.1);
}
.marker-orange {
    filter: hue-rotate(180deg);
}
.marker-cyan {
    filter: hue-rotate(325deg) contrast(1.8);
}
.marker-green {
    filter: hue-rotate(240deg);
}
.marker-light-green {
    filter: hue-rotate(240deg) grayscale(0.5) brightness(1.5);
}

.legend-marker {
    display: inline-block;
    background-image: url(https://unpkg.com/leaflet@1.6.0/dist/images/marker-icon-2x.png);
    background-position: center;
    background-size: contain;
    width: 0.75em;
    height: 1.23em;
}
</style>
</head>
<body>
<h1>–ö–∞—Ä—Ç–∞ –ø—É–Ω–∫—Ç–æ–≤ –ø—Ä–∏—ë–º–∞ –≤—Ç–æ—Ä—Å—ã—Ä—å—è –ú–§–¢–ò</h1>
<a href="https://vk.com/green_tech_mipt" target="_blank">–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏</a>
&bullet;
<a href="https://github.com/diht2016/green-tech-mipt/issues" target="_blank">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ –∫–∞—Ä—Ç–µ</a>
&bullet;
–ê–∫—Ç—É–∞–ª—å–Ω–æ –Ω–∞ 2020.07.19
<div id="map-container"></div>
<button id="text-button" onclick="toggleHidden(filter)">üîç –§–∏–ª—å—Ç—Ä –º–µ—Å—Ç –ø–æ —Ç–∏–ø–∞–º –≤—Ç–æ—Ä—Å—ã—Ä—å—è</button>
<button id="text-button" onclick="toggleHidden(legend)"><span class="legend-marker marker-green" style="vertical-align: text-bottom;"></span> –õ–µ–≥–µ–Ω–¥–∞ –∫–∞—Ä—Ç—ã</button>
<button id="text-button" onclick="toggleHidden(textList)">üìú –ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –≤—Å–µ –ø—É–Ω–∫—Ç—ã</button>
<div id="text-list" class="bordered-box" hidden>...</div>
<div id="legend" class="bordered-box" hidden>
–†–∞–∑–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏ —É–∫–∞–∑–∞–Ω—ã —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –ø—É–Ω–∫—Ç–æ–≤:
<ul style="list-style: none;">
<li>
<span class="legend-marker marker-green"></span>
<span class="legend-marker marker-light-green"></span>
 - –≤–Ω–µ—à–Ω–∏–µ –ø—É–Ω–∫—Ç—ã —Å–±–æ—Ä–∞ –≤—Ç–æ—Ä—Å—ã—Ä—å—è</li>
<li>
<span class="legend-marker marker-blue"></span>
<span class="legend-marker marker-blue-gray"></span>
 - –æ–±—â–µ–∂–∏—Ç–∏—è, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –ø—É–Ω–∫—Ç—ã —Å–±–æ—Ä–∞ –≤—Ç–æ—Ä—Å—ã—Ä—å—è (–≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –º–∞–∫—É–ª–∞—Ç—É—Ä–∞, –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏, –∫–∞–Ω–∏—Å—Ç—Ä—ã –∏ –∫—Ä—ã—à–µ—á–∫–∏, –∞ —Ç–∞–∫–∂–µ —Ä—É—á–∫–∏, –∑—É–±–Ω—ã–µ —â—ë—Ç–∫–∏, –º–∞—Ä–∫–µ—Ä—ã –∏ —Ñ–ª–æ–º–∞—Å—Ç–µ—Ä—ã)</li>
<li>
<span class="legend-marker marker-gray"></span>
 - –æ–±—â–µ–∂–∏—Ç–∏—è, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –ø—É–Ω–∫—Ç–æ–≤ —Å–±–æ—Ä–∞ –≤—Ç–æ—Ä—Å—ã—Ä—å—è</li>
<li>
<span class="legend-marker marker-orange"></span>
 - –ø—É–Ω–∫—Ç—ã –ø—Ä–∏—ë–º–∞ –æ–ø–∞—Å–Ω—ã—Ö –æ—Ç—Ö–æ–¥–æ–≤ (–≤ –æ—Å–Ω–æ–≤–Ω–æ–º, –±–∞—Ç–∞—Ä–µ–µ–∫)</li>
<li>
<span class="legend-marker marker-cyan"></span>
 - –ø—É–Ω–∫—Ç—ã –ø—Ä–∏—ë–º–∞ –æ–¥–µ–∂–¥—ã –∏ –æ–±—É–≤–∏</li>
</ul>
<br>
–ù–∞ –∫–∞—Ä—Ç–µ —Ç–∞–∫–∂–µ –æ—Ç–º–µ—á–µ–Ω—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—É–Ω–∫—Ç—ã –≤ –≥–æ—Ä–æ–¥–µ –î–æ–ª–≥–æ–ø—Ä—É–¥–Ω—ã–π –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –∫–∞–º–ø—É—Å–∞ –ú–§–¢–ò.
</div>
<div id="filter" class="bordered-box" hidden>
<div id="filter-select"></div>
<p>–ù–µ –Ω–∞—à–ª–∏ –≤ —Å–ø–∏—Å–∫–µ –Ω—É–∂–Ω—ã–π –≤–∏–¥ –≤—Ç–æ—Ä—Å—ã—Ä—å—è? –ï—Å–ª–∏ —ç—Ç–æ—Ç –≤–∏–¥ –µ—Å—Ç—å –≤ <a target="_blank" href="https://sobirator.ru/list">–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</a> –°–æ–±–∏—Ä–∞—Ç–æ—Ä–∞, —Ç–æ –µ–≥–æ –º–æ–∂–Ω–æ —Å–¥–∞–≤–∞—Ç—å –Ω–∞ –∞–∫—Ü–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è —É –≥–ª–∞–≤–Ω–æ–≥–æ –ø—É–Ω–∫—Ç–∞ –∑–∞ 4 –æ–±—â–µ–∂–∏—Ç–∏–µ–º (—Ç—ë–º–Ω–æ-–∑–µ–ª—ë–Ω–∞—è –º–µ—Ç–∫–∞). –ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ –¥–∞—Ç—ã –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Å–º–æ—Ç—Ä–∏—Ç–µ <a target="_blank" href="https://vk.com/waste_sorting">—Ç—É—Ç</a>.</p>
</div>
<script>
let textList = document.getElementById('text-list')
let legend = document.getElementById('legend')
let filter = document.getElementById('filter')

function toggleHidden(elem) {
    if (elem.hidden) {
        // close all boxes before opening this box
        for (let otherElem of document.getElementsByClassName('bordered-box')) {
            otherElem.hidden = true
        }
    }
    elem.hidden = !elem.hidden
    
    if (!elem.hidden) {
        scrollToElement(elem)
    }
}

function scrollToElement(elem, limit=40, iter=0, k=0.12, delay=15) {
    if (iter >= limit) {
        return
    }
    let rect = elem.getClientRects()[0]
    if (!rect) {
        return
    }
    let delta = rect.top * k
    document.documentElement.scrollTop += delta
    setTimeout(scrollToElement, delay, elem, limit, iter + 1, k, delay)
}

// util functions
let wrap = (content, tagName) => '<' + tagName + '>' + content + '</' + tagName + '>'
let capitalize = (str) => str[0].toUpperCase() + str.slice(1)


let global = {
    coords: [55.93001, 37.52196],
    minZoom: 14,
    zoom: 16,
    maxZoom: 19,
}

// json database of all places
let places = [
    // –æ–±—â–µ–∂–∏—Ç–∏—è
    {
        id: '1',
        coords: [55.93088, 37.52158],
        items: [
            {
                title: '–ú–∞–∫—É–ª–∞—Ç—É—Ä–∞',
                info: '1 —ç—Ç–∞–∂, –±–æ—Ç–∞–ª–∫–∞ (—Å–ø—Ä–∞–≤–∞ –ø–æ—Å–ª–µ —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞), –∫–æ—Ä–æ–±–∫–∞ —Å–ø—Ä–∞–≤–∞ –ø–æ–¥ –∫–Ω–∏–∂–Ω–æ–π –ø–æ–ª–∫–æ–π'
            },
            {
                title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –∫–∞–Ω–∏—Å—Ç—Ä—ã, –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –±–∞–Ω–∫–∏',
                info: '—é–∂–Ω–∞—è –∫—É—Ö–Ω—è 2-–≥–æ —ç—Ç–∞–∂–∞, –∞ —Ç–∞–∫–∂–µ —Å–µ–≤–µ—Ä–Ω–∞—è –∫—É—Ö–Ω—è 4-–≥–æ —ç—Ç–∞–∂–∞, –∑–µ–ª—ë–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã'
            },
            {
                title: '–°—Ç–µ–∫–ª–æ (–º—ã—Ç–æ–µ, –±–µ–∑ –∫—Ä—ã—à–µ–∫)',
                info: '1 —ç—Ç–∞–∂, –∫—É—Ö–Ω—è, –∑–µ–ª—ë–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä'
            },
        ],
        //comment: '–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—É–Ω–∫—Ç—ã —Å–±–æ—Ä–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è (–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–æ - –≤ –¥–µ–∫–∞–±—Ä–µ 2019)',
        type: 'blue',
    },
    {
        id: '2',
        coords: [55.93016, 37.52193],
        items: [
            {
                title: '–ú–∞–∫—É–ª–∞—Ç—É—Ä–∞',
                info: '1 —ç—Ç–∞–∂, –±–æ—Ç–∞–ª–∫–∞ (—Å–ø—Ä–∞–≤–∞ –¥–æ —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞), –∫–æ—Ä–æ–±–∫–∏ —Å–±–æ–∫—É'
            },
            {
                title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏, –∫–∞–Ω–∏—Å—Ç—Ä—ã –∏ –∫—Ä—ã—à–µ—á–∫–∏, –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –±–∞–Ω–∫–∏',
                info: '3 —ç—Ç–∞–∂, —é–∂–Ω–∞—è –∫—É—Ö–Ω—è, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É –æ–∫–Ω–∞ –∏ –ø—è—Ç–∏–ª–∏—Ç—Ä–æ–≤–∫–∞ –¥–ª—è –∫—Ä—ã—à–µ–∫ –Ω–∞ –æ–∫–Ω–µ'
            },
            {
                title: '–†—É—á–∫–∏, –º–∞—Ä–∫–µ—Ä—ã, —Ñ–ª–æ–º–∞—Å—Ç–µ—Ä—ã, –∑—É–±–Ω—ã–µ —â—ë—Ç–∫–∏',
                info: '–≤ –æ–±–æ–∏—Ö –ø—É–Ω–∫—Ç–∞—Ö (–æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤—ã—à–µ) —Ä—è–¥–æ–º —Å—Ç–æ–∏—Ç –ø—è—Ç–∏–ª–∏—Ç—Ä–æ–≤–∫–∞'
            },
        ],
        type: 'blue',
    },
    {
        id: '3',
        coords: [55.92929, 37.52247],
        items: [
            {
                title: '–ú–∞–∫—É–ª–∞—Ç—É—Ä–∞',
                info: '3 —ç—Ç–∞–∂, –±–æ—Ç–∞–ª–∫–∞'
            },
        ],
        type: 'blue-gray',
    },
    {
        id: '4',
        coords: [55.93108, 37.52293],
        items: null,
        comment: '–ü—É–Ω–∫—Ç–æ–≤ —Å–±–æ—Ä–∞ –≤–Ω—É—Ç—Ä–∏ –æ–±—â–µ–∂–∏—Ç–∏—è –ø–æ–∫–∞ —á—Ç–æ –Ω–µ—Ç, –Ω–æ —Ä—è–¥–æ–º —Å –æ–±—â–µ–∂–∏—Ç–∏–µ–º –µ—Å—Ç—å –≥–ª–∞–≤–Ω—ã–π –ø—É–Ω–∫—Ç –ø—Ä–∏—ë–º–∞, –∫—É–¥–∞ –º–æ–∂–Ω–æ —Å–¥–∞—Ç—å –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –º–∞–∫—É–ª–∞—Ç—É—Ä—É.',
        type: 'gray',
    },
    {
        id: '6',
        coords: [55.92948, 37.52373],
        items: [
            {
                title: '–ú–∞–∫—É–ª–∞—Ç—É—Ä–∞',
                info: '3 —ç—Ç–∞–∂, –±–æ—Ç–∞–ª–∫–∞, –∫–æ—Ä–æ–±–∫–∞ –Ω–∞ –∫–Ω–∏–∂–Ω–æ–º —à–∫–∞—Ñ—É —Å–ª–µ–≤–∞'
            },
            {
                title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏, –∫–∞–Ω–∏—Å—Ç—Ä—ã –∏ –∫—Ä—ã—à–µ—á–∫–∏, –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –±–∞–Ω–∫–∏',
                info: '–≤—Å–µ —ç—Ç–∞–∂–∏ –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ, —É–º—ã–≤–∞–ª–∫–∞'
            },
            {
                title: '–†—É—á–∫–∏, –º–∞—Ä–∫–µ—Ä—ã, —Ñ–ª–æ–º–∞—Å—Ç–µ—Ä—ã, –∑—É–±–Ω—ã–µ —â—ë—Ç–∫–∏',
                info: '–ø—è—Ç–∏–ª–∏—Ç—Ä–æ–≤–∫–∏ —Ä—è–¥–æ–º —Å –ø—É–Ω–∫—Ç–∞–º–∏ —Å–±–æ—Ä–∞ –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã—Ö –±—É—Ç—ã–ª–æ–∫'
            },
        ],
        type: 'blue',
   },
    {
        id: '7',
        coords: [55.92892, 37.52329],
        items: [
            {
                title: '–ú–∞–∫—É–ª–∞—Ç—É—Ä–∞',
                info: '1 —ç—Ç–∞–∂, –≥—Ä–æ–º–∫–∞—è –±–æ—Ç–∞–ª–∫–∞, –∫–æ—Ä–æ–±–∫–∞ –Ω–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–µ (–¥–ª—è –ø–æ–ª–µ–∑–Ω—ã—Ö –∫–æ–Ω—Å–ø–µ–∫—Ç–æ–≤ –µ—Å—Ç—å –∫–æ—Ä–æ–±–∫–∞ —É –≤—Ö–æ–¥–∞)'
            },
            {
                title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏, –∫–∞–Ω–∏—Å—Ç—Ä—ã –∏ –∫—Ä—ã—à–µ—á–∫–∏, –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –±–∞–Ω–∫–∏',
                info: '—é–∂–Ω–∞—è –∫—É—Ö–Ω—è 3-–≥–æ —ç—Ç–∞–∂–∞, –∞ —Ç–∞–∫–∂–µ —Å–µ–≤–µ—Ä–Ω–∞—è –∫—É—Ö–Ω—è 2-–≥–æ —ç—Ç–∞–∂–∞, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —É –≤—Ö–æ–¥–∞ –∏ –ø—è—Ç–∏–ª–∏—Ç—Ä–æ–≤–∫–∞ –¥–ª—è –∫—Ä—ã—à–µ—á–µ–∫ –Ω–∞ –æ–∫–Ω–µ'
            },
            {
                title: '–†—É—á–∫–∏, –º–∞—Ä–∫–µ—Ä—ã, —Ñ–ª–æ–º–∞—Å—Ç–µ—Ä—ã, –∑—É–±–Ω—ã–µ —â—ë—Ç–∫–∏',
                info: '1 —ç—Ç–∞–∂, –≥—Ä–æ–º–∫–∞—è –±–æ—Ç–∞–ª–∫–∞, –ø—è—Ç–∏–ª–∏—Ç—Ä–æ–≤–∫–∞ –≤ –¥–∞–ª—å–Ω–µ–º —É–≥–ª—É'
            },
        ],
        type: 'blue',
    },
    {
        id: '8',
        coords: [55.92812, 37.52351],
        items: [
            {
                title: '–ú–∞–∫—É–ª–∞—Ç—É—Ä–∞',
                info: '3 —ç—Ç–∞–∂, –±–µ–ª—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ –∫–æ–º–Ω–∞—Ç–∫–µ —Å –º—É—Å–æ—Ä–æ–ø—Ä–æ–≤–æ–¥–æ–º'
            },
            {
                title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏, –∫–∞–Ω–∏—Å—Ç—Ä—ã –∏ –∫—Ä—ã—à–µ—á–∫–∏, –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –±–∞–Ω–∫–∏',
                info: '—Å–µ–≤–µ—Ä–Ω–æ–µ –∫—Ä—ã–ª–æ, –∫–æ–º–Ω–∞—Ç–∫–∏ —Å –º—É—Å–æ—Ä–æ–ø—Ä–æ–≤–æ–¥–æ–º –Ω–∞ 3 –∏ 5 —ç—Ç–∞–∂–∞—Ö'
                //info: '—Å–µ–≤–µ—Ä–Ω–æ–µ –∫—Ä—ã–ª–æ, –∫–æ–º–Ω–∞—Ç–∫–∏ —Å –º—É—Å–æ—Ä–æ–ø—Ä–æ–≤–æ–¥–æ–º –Ω–∞ 3 –∏ 5 —ç—Ç–∞–∂–∞—Ö, —Å–µ–≤–µ—Ä–Ω–∞—è –∫—É—Ö–Ω—è –Ω–∞ 7 —ç—Ç–∞–∂–µ'
            },
            {
                title: '–†—É—á–∫–∏, –º–∞—Ä–∫–µ—Ä—ã, —Ñ–ª–æ–º–∞—Å—Ç–µ—Ä—ã, –∑—É–±–Ω—ã–µ —â—ë—Ç–∫–∏',
                info: '–ø—è—Ç–∏–ª–∏—Ç—Ä–æ–≤–∫–∏ —Ä—è–¥–æ–º —Å –ø—É–Ω–∫—Ç–∞–º–∏ —Å–±–æ—Ä–∞ –ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã—Ö –±—É—Ç—ã–ª–æ–∫'
            },
        ],
        type: 'blue',
    },
    {
        id: '9',
        coords: [55.92728, 37.52359],
        comment: '–ü—É–Ω–∫—Ç–æ–≤ —Å–±–æ—Ä–∞ –≤ –æ–±—â–µ–∂–∏—Ç–∏–∏ –Ω–µ—Ç (—Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ –∫–≤–∞—Ä—Ç–∏—Ä–Ω–æ–≥–æ —Ç–∏–ø–∞), –Ω–æ —Ä—è–¥–æ–º –µ—Å—Ç—å —Å–∏–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã',
        type: 'gray',
    },
    {
        id: '10and11',
        name: '–û–±—â–µ–∂–∏—Ç–∏—è ‚Ññ10 –∏ ‚Ññ11',
        coords: [55.93038, 37.52255],
        comment: '–ü—É–Ω–∫—Ç–æ–≤ —Å–±–æ—Ä–∞ –≤ —ç—Ç–∏—Ö –æ–±—â–µ–∂–∏—Ç–∏—è—Ö –Ω–µ—Ç (—Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –∫–≤–∞—Ä—Ç–∏—Ä–Ω–æ–≥–æ —Ç–∏–ø–∞), –Ω–æ –Ω–µ–ø–æ–¥–∞–ª—ë–∫—É –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π –ø—É–Ω–∫—Ç –ø—Ä–∏—ë–º–∞ –≤—Ç–æ—Ä—Å—ã—Ä—å—è (–∑–∞ 4-—ã–º –æ–±—â–µ–∂–∏—Ç–∏–µ–º)',
        type: 'gray',
    },
    {
        id: '12',
        coords: [55.93161, 37.51890],
        items: [
            {
                title: '–≠–ª–µ–∫—Ç—Ä–æ—Ö–ª–∞–º',
                info: '1 —ç—Ç–∞–∂, –ø–ª–∞—Å—Ç–∏–∫–æ–≤–∞—è –∫–æ—Ä–æ–±–∫–∞ —Ä—è–¥–æ–º —Å –ø—Ä–∏–Ω—Ç–±–æ–∫—Å–æ–º'
            },
            {
                title: '–†—É—á–∫–∏, –º–∞—Ä–∫–µ—Ä—ã, —Ñ–ª–æ–º–∞—Å—Ç–µ—Ä—ã, –∑—É–±–Ω—ã–µ —â—ë—Ç–∫–∏, CD –∏ DVD –¥–∏—Å–∫–∏, —Ç—Ä—É–±–æ—á–∫–∏ –æ—Ç –Ω–∞–ø–∏—Ç–∫–æ–≤, –±—Ä–∏—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç–∞–Ω–∫–∏, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Ç –ª–∏–Ω–∑',
                info: '1 —ç—Ç–∞–∂, –ø—è—Ç–∏–ª–∏—Ç—Ä–æ–≤–∫–∞ –Ω–∞ —Å—Ç–æ–ª–∏–∫–µ –ø—Ä–∏–Ω—Ç–±–æ–∫—Å–∞'
            },
        ],
        //comment: '–ü—É–Ω–∫—Ç —Å–±–æ—Ä–∞ –ø–ª–∞—Å—Ç–∏–∫–∞ –∏ —Å–∏–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –µ—Å—Ç—å –∑–∞ –≤–æ—Ä–æ—Ç–∞–º–∏. –í–æ–∑–º–æ–∂–Ω–æ, –≤ –±—É–¥—É—â–µ–º –Ω–∞ 1 —ç—Ç–∞–∂–µ –ø–æ—è–≤–∏—Ç—Å—è –ø—É–Ω–∫—Ç —Å–±–æ—Ä–∞ –º–∞–∫—É–ª–∞—Ç—É—Ä—ã.',
        type: 'blue-gray',
    },

    // –∫–æ—Ä–ø—É—Å–∞
    {
        id: 'kpm',
        name: '–ö–ü–ú',
        coords: [55.92899, 37.52141],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '2 —ç—Ç–∞–∂, —É –≤—Ö–æ–¥–∞ –≤ —Å—Ç–æ–ª–æ–≤—É—é, –∞ —Ç–∞–∫–∂–µ 1 —ç—Ç–∞–∂, —É –≤—Ö–æ–¥–∞ –≤ –ú–§–¢–ò-—Ç–µ–ª–µ–∫–æ–º'
            },
        ],
        type: 'orange',
    },
    {
        id: 'nk',
        name: '–ù–ö',
        coords: [55.92949, 37.52059],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '1 —ç—Ç–∞–∂, –≥–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥, –≤ –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –º–µ–∂–¥—É –¥–≤–µ—Ä—è–º–∏ (—Å–ø—Ä–∞–≤–∞, –µ—Å–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å —Å —É–ª–∏—Ü—ã)'
            },
        ],
        type: 'orange',
    },
    {
        id: 'hall',
        name: '–ö–æ–Ω—Ü–µ—Ä—Ç–Ω—ã–π –∑–∞–ª',
        coords: [55.92972, 37.51742],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '1 —ç—Ç–∞–∂, –≥–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥, –≤ –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –º–µ–∂–¥—É –¥–≤–µ—Ä—è–º–∏ (—Å–ø—Ä–∞–≤–∞, –µ—Å–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å —Å —É–ª–∏—Ü—ã)'
            },
        ],
        type: 'orange',
    },
    {
        id: 'lk',
        name: '–õ–ö',
        coords: [55.93016, 37.51800],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '1 —ç—Ç–∞–∂, –≥–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥, –≤ –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –º–µ–∂–¥—É –¥–≤–µ—Ä—è–º–∏ (—Å–ª–µ–≤–∞, –µ—Å–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å —Å —É–ª–∏—Ü—ã)'
            },
        ],
        type: 'orange',
    },
    {
        id: 'ak',
        name: '–ê–ö',
        coords: [55.93086, 37.51958],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '1 —ç—Ç–∞–∂, –≥–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥, –≤ –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –º–µ–∂–¥—É –¥–≤–µ—Ä—è–º–∏ (—Å–ø—Ä–∞–≤–∞, –µ—Å–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å —Å —É–ª–∏—Ü—ã)'
            },
        ],
        type: 'orange',
    },
    {
        id: 'bfk',
        name: '–ë–§–ö',
        coords: [55.92980, 37.51583],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '1 —ç—Ç–∞–∂, –≥–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥, –≤ –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –º–µ–∂–¥—É –¥–≤–µ—Ä—è–º–∏ (—Å–ø—Ä–∞–≤–∞, –µ—Å–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å —Å —É–ª–∏—Ü—ã)'
            },
        ],
        type: 'orange',
    },
    {
        id: 'ulk1',
        name: '–§–∏–∑—Ç–µ—Ö.–¶–∏—Ñ—Ä–∞',
        coords: [55.92903, 37.51864],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '1 —ç—Ç–∞–∂, —Ä—è–¥–æ–º —Å —Ç—É—Ä–Ω–∏–∫–µ—Ç–∞–º–∏ —É –≥–ª–∞–≤–Ω–æ–≥–æ –≤—Ö–æ–¥–∞'
            },
        ],
        type: 'orange',
    },
    {
        id: 'ulk2',
        name: '–§–∏–∑—Ç–µ—Ö.–ê—Ä–∫—Ç–∏–∫–∞',
        coords: [55.92833, 37.51828],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '1 —ç—Ç–∞–∂, –≥–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥, –≤ –ø—Ä–æ–º–µ–∂—É—Ç–∫–µ –º–µ–∂–¥—É –¥–≤–µ—Ä—è–º–∏ (—É –∫–æ–ª–æ–Ω–Ω—ã –ø–æ —Ü–µ–Ω—Ç—Ä—É)'
            },
        ],
        type: 'orange',
    },

    // –≤–Ω–µ—à–Ω–∏–µ –ø—É–Ω–∫—Ç—ã
    {
        id: 'mainpoint',
        name: '–û—Å–Ω–æ–≤–Ω–æ–π –ø—É–Ω–∫—Ç –ø—Ä–∏—ë–º–∞ –≤—Ç–æ—Ä—Å—ã—Ä—å—è',
        coords: [55.93140, 37.52331],
        items: [
            {
                title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏, –∫–∞–Ω–∏—Å—Ç—Ä—ã –∏ –∫—Ä—ã—à–µ—á–∫–∏, –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –±–∞–Ω–∫–∏',
                info: '–¥–≤–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞-–∫–ª–µ—Ç–∫–∏ –ø–µ—Ä–µ–¥ –¥–æ–º–∏–∫–æ–º (–Ω–∞ —Ç–∞–±–ª–∏—á–∫–µ –Ω–µ –Ω–∞–ø–∏—Å–∞–Ω–æ –ø—Ä–æ –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –±–∞–Ω–∫–∏, –Ω–æ –æ–Ω–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –∏ –ø–µ—Ä–µ—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è)'
            },
            {
                title: '–°—Ç–µ–∫–ª–æ (–±—É—Ç—ã–ª–∫–∏, –±–∞–Ω–∫–∏, –æ–∫–æ–Ω–Ω–æ–µ —Å—Ç–µ–∫–ª–æ)',
                info: '–∑–µ–ª—ë–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ–¥ –¥–æ–º–∏–∫–æ–º'
            },
            {
                title: '–ú–∞–∫—É–ª–∞—Ç—É—Ä–∞',
                info: '—Å –∑–∞–¥–Ω–µ–π —Å—Ç–æ—Ä–æ–Ω—ã –¥–æ–º–∏–∫–∞ –µ—Å—Ç—å –æ–∫–æ—à–∫–æ, –≤ –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ —Å–¥–∞—Ç—å –º–∞–∫—É–ª–∞—Ç—É—Ä—É (–µ—Å–ª–∏ –Ω–µ –≤–ª–µ–∑–∞–µ—Ç - –º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å —É –æ–∫–æ—à–∫–∞ —Ä—è–¥–æ–º)'
            },
        ],
        comment: '–ó–¥–µ—Å—å –ø–æ –≤—ã—Ö–æ–¥–Ω—ã–º –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –∞–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä—É <a target="_blank" href="https://sobirator.ru/list">–±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –≤–∏–¥–æ–≤ –≤—Ç–æ—Ä—Å—ã—Ä—å—è</a>, –ø–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ –∞–∫—Ü–∏–∏ –≤ —ç—Ç–æ–º –º–µ—Å—Ç–µ –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å <a target="_blank" href="https://vk.com/waste_sorting">–∑–¥–µ—Å—å</a>.',
        // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å—Ç–µ–∫–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω 2020-03-09
        type: 'green',
    },
    {
        id: 'bluebox8',
        name: '–°–∏–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–µ–∂–¥—É –æ–±—â–µ–∂–∏—Ç–∏—è–º–∏ ‚Ññ8 –∏ ‚Ññ9',
        coords: [55.92768, 37.52382],
        items: [
            {title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –∫–∞–Ω–∏—Å—Ç—Ä—ã'},
            {title: '–ê–ª—é–º–∏–Ω–∏–π –∏ –∂–µ–ª–µ–∑–æ'},
            {title: '–ö–∞—Ä—Ç–æ–Ω–Ω—ã–µ –∫–æ—Ä–æ–±–∫–∏'},
            {title: '–°—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –±–∞–Ω–∫–∏'},
        ],
        type: 'light-green',
    },
    {
        id: 'bluebox9',
        name: '–°–∏–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É –¥–æ—Ä–æ–∂–∫–∏ –Ω–∞ –ù–æ–≤–æ–¥–∞—á–Ω—É—é',
        coords: [55.92699, 37.52419],
        items: [
            {title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –∫–∞–Ω–∏—Å—Ç—Ä—ã'},
            {title: '–ê–ª—é–º–∏–Ω–∏–π –∏ –∂–µ–ª–µ–∑–æ'},
            {title: '–ö–∞—Ä—Ç–æ–Ω–Ω—ã–µ –∫–æ—Ä–æ–±–∫–∏'},
            {title: '–°—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –±–∞–Ω–∫–∏'},
        ],
        type: 'light-green',
    },
    {
        id: 'bluebox12outer',
        name: '–°–∏–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É –≤–æ—Ä–æ—Ç –æ–±—â–µ–∂–∏—Ç–∏—è ‚Ññ12',
        coords: [55.93215, 37.51930],
        items: [
            {title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –∫–∞–Ω–∏—Å—Ç—Ä—ã'},
            {title: '–ê–ª—é–º–∏–Ω–∏–π –∏ –∂–µ–ª–µ–∑–æ'},
            {title: '–ö–∞—Ä—Ç–æ–Ω–Ω—ã–µ –∫–æ—Ä–æ–±–∫–∏'},
            {title: '–°—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –±–∞–Ω–∫–∏'},
        ],
        type: 'light-green',
    },
    {
        id: 'bluebox12',
        name: '–°–∏–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –æ–±—â–µ–∂–∏—Ç–∏—è ‚Ññ12',
        coords: [55.93195, 37.51915],
        items: [
            {title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –∫–∞–Ω–∏—Å—Ç—Ä—ã'},
            {title: '–ê–ª—é–º–∏–Ω–∏–π –∏ –∂–µ–ª–µ–∑–æ'},
            {title: '–ö–∞—Ä—Ç–æ–Ω–Ω—ã–µ –∫–æ—Ä–æ–±–∫–∏'},
            {title: '–°—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –±–∞–Ω–∫–∏'},
        ],
        type: 'light-green',
    },
    /*
    {
        id: 'orangebox12',
        name: '–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä-–∫–ª–µ—Ç–∫–∞ —É –≤–æ—Ä–æ—Ç –æ–±—â–µ–∂–∏—Ç–∏—è ‚Ññ12',
        coords: [55.93219, 37.51935],
        items: [
            {title: '–ü–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –∫–∞–Ω–∏—Å—Ç—Ä—ã'},
        ],
        type: 'light-green',
    },
    */
    {
        id: 'vkusvill',
        name: '–í–∫—É—Å–í–∏–ª–ª',
        coords: [55.93960, 37.51709],
        items: [
            {
                title: '–ë–∞—Ç–∞—Ä–µ–π–∫–∏',
                info: '–≤–Ω—É—Ç—Ä–∏ —É –≤—Ö–æ–¥–∞ –Ω–∞ —Å—Ç–æ–ª–µ —Å—Ç–æ–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä'
            },
        ],
        comment: '–ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ —Ç–æ, –∫–∞–∫ –í–∫—É—Å–í–∏–ª–ª –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –±–∞—Ç–∞—Ä–µ–π–∫–∏: <a target="_blank" href="https://vkusvill.ru/news/prinimaem-batareyki.html">1</a>, <a target="_blank" href="https://vkusvill.ru/news/pervyy-po-batareykam.html">2</a>, <a target="_blank" href="https://vkusvill.ru/news/batareyki-na-utilizatsiyu.html">3</a>',
        type: 'orange',
    },
    {
        id: 'mercurybox',
        name: '–û—Ä–∞–Ω–∂–µ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞ –¥–æ–º–æ–º –∫—É–ª—å—Ç—É—Ä—ã',
        coords: [55.93433, 37.51406],
        items: [
            {title: '–≠–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–≥–∞—é—â–∏–µ (—Ä—Ç—É—Ç–Ω—ã–µ) –ª–∞–º–ø—ã, –±–∞—Ç–∞—Ä–µ–π–∫–∏, –≥—Ä–∞–¥—É—Å–Ω–∏–∫–∏'},
        ],
        comment: '<a target="_blank" href="https://ecobox.ru/product-category/energolamp/">–ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä</a>',
        type: 'orange',
    },
    
    {
        id: 'clothesbox_konfitur',
        name: '–ë–∏—Ä—é–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É –≤—Ö–æ–¥–∞ –≤ —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä "–ö–æ–Ω—Ñ–∏—Ç—é—Ä"',
        coords: [55.93133, 37.49366],
        items: [
            {title: '–û–¥–µ–∂–¥–∞, –æ–±—É–≤—å, —Å—É–º–∫–∏ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã (–∫—Ä–æ–º–µ –Ω–∏–∂–Ω–µ–≥–æ –±–µ–ª—å—è, –Ω–æ—Å–∫–æ–≤ –∏ –∫–æ–ª–≥–æ—Ç–æ–∫)'},
        ],
        comment: '–í–µ—â–∏ —Å–æ–±–∏—Ä–∞–µ—Ç <a target="_blank" href="https://vtoroe.ru/">–í—Ç–æ—Ä–æ–µ –¥—ã—Ö–∞–Ω–∏–µ</a>. –ü—Ä–æ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏—ë–º–∞ <a target="_blank" href="https://vtoroe.ru/modno-sdat/chto-mozhno-sdavat/">—á–∏—Ç–∞–π—Ç–µ —Ç—É—Ç</a>.',
        type: 'cyan',
    },
    
    {
        id: 'clothesbox_polet',
        name: '–ë–∏—Ä—é–∑–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É –≤—Ö–æ–¥–∞ –≤ —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä "–ü–æ–ª—ë—Ç"',
        coords: [55.94628, 37.50619],
        items: [
            {title: '–û–¥–µ–∂–¥–∞, –æ–±—É–≤—å, —Å—É–º–∫–∏ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã (–∫—Ä–æ–º–µ –Ω–∏–∂–Ω–µ–≥–æ –±–µ–ª—å—è, –Ω–æ—Å–∫–æ–≤ –∏ –∫–æ–ª–≥–æ—Ç–æ–∫)'},
        ],
        comment: '–í–µ—â–∏ —Å–æ–±–∏—Ä–∞–µ—Ç <a target="_blank" href="https://vtoroe.ru/">–í—Ç–æ—Ä–æ–µ –¥—ã—Ö–∞–Ω–∏–µ</a>. –ü—Ä–æ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏—ë–º–∞ <a target="_blank" href="https://vtoroe.ru/modno-sdat/chto-mozhno-sdavat/">—á–∏—Ç–∞–π—Ç–µ —Ç—É—Ç</a>.',
        type: 'cyan',
    },
    
]

let inactiveItemMessages = (item) => {
    //if (item.info && item.info.includes("–±–æ—Ç–∞–ª–∫")) {
    //    // all book rooms are closed now
    //    return "–ë–æ—Ç–∞–ª–∫–∏ –≤ –æ–±—â–µ–∂–∏—Ç–∏—è—Ö –∑–∞–∫—Ä—ã—Ç—ã –≤ —Å–≤—è–∑–∏ —Å —Ä–µ–∂–∏–º–æ–º —Å–∞–º–æ–∏–∑–æ–ª—è—Ü–∏–∏"
    //}
    return null
}

// data completion
for (let p of places) {
    if (p.id.match(/^\d+$/) && !p.name) {
        p.name = '–û–±—â–µ–∂–∏—Ç–∏–µ ‚Ññ' + p.id
    }
    
    // disable all inactive items
    if (inactiveItemMessages && p.items) {
        p.items.forEach((item) => {
            let inactiveFor = inactiveItemMessages(item)
            if (inactiveFor) {
                item.disabled = inactiveFor
            }
        })
    }
}


// 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}'
// id: 'mapbox.streets',
// accessToken: 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw'

function createMap(elementId) {
    let map = L.map(elementId).setView(global.coords, global.zoom)

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
        maxZoom: global.maxZoom,
        minZoom: global.minZoom,
    }).addTo(map)

    let textListHTML = ''
    
    // process places, create markers
    for (let p of places) {
        let marker = L.marker(p.coords, {
            alt: p.name,
        }).addTo(map)
        
        let content = wrap(p.name + ':', 'h3')
        if (p.items) {
            content += wrap(p.items.map(item => {
                    let content = wrap(item.title, 'b') + (item.info ? ': ' + item.info : '')
                    if (item.disabled) {
                        content = wrap(content, 's') + ' [' + item.disabled + ']'
                        content = '<span style="opacity: 0.5">' + content + '</span>'
                    }
                    return wrap(content, 'li')
                }).join(''), 'ul')
        }
        if (p.comment) {
            content += wrap(p.comment, 'p')
        }
        
        textListHTML += content

        let popup = L.popup()
            .setLatLng(p.coords)
            .setContent(content)
        
        marker.addEventListener('click', () => popup.openOn(map))
        marker.bindTooltip(p.name)
        marker._icon.classList.add('marker-' + p.type)
        p._marker = marker
    }
    
    textList.innerHTML = textListHTML
    
    return map
}

let map = createMap('map-container')



let filterOptions = [
    {
        title: '–ø–æ–∫–∞–∑–∞—Ç—å –≤—Å—ë',
        match: '*',
    },
    {
        title: '–º–∞–∫—É–ª–∞—Ç—É—Ä–∞ (–±—É–º–∞–≥–∞ –∏ –∫–∞—Ä—Ç–æ–Ω)',
        match: '–º–∞–∫—É–ª–∞—Ç—É—Ä',
    },
    {
        title: '–ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –±—É—Ç—ã–ª–∫–∏ –∏ –∫–∞–Ω–∏—Å—Ç—Ä—ã',
        match: '–ø–ª–∞—Å—Ç–∏–∫',
    },
    {
        title: '–ø–ª–∞—Å—Ç–∏–∫–æ–≤—ã–µ –∫—Ä—ã—à–µ—á–∫–∏',
        match: '–∫—Ä—ã—à–µ—á–∫–∏',
    },
    {
        title: '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –±–∞–Ω–∫–∏',
        match: '–∞–ª—é–º–∏–Ω',
    },
    {
        title: '—Å—Ç–µ–∫–ª–æ',
        match: '—Å—Ç–µ–∫–ª',
    },
    {
        title: '—Ä—É—á–∫–∏, –∑—É–±–Ω—ã–µ —â—ë—Ç–∫–∏, –º–∞—Ä–∫–µ—Ä—ã –∏ —Ñ–ª–æ–º–∞—Å—Ç–µ—Ä—ã',
        match: '–∑—É–±–Ω',
    },
    {
        title: '–±–∞—Ç–∞—Ä–µ–π–∫–∏',
        match: '–±–∞—Ç–∞—Ä–µ–π–∫',
    },
    {
        title: '—Ä—Ç—É—Ç–Ω—ã–µ –ª–∞–º–ø—ã –∏ –≥—Ä–∞–¥—É—Å–Ω–∏–∫–∏',
        match: '—Ä—Ç—É—Ç',
    },
    {
        title: '–æ–¥–µ–∂–¥–∞ –∏ –æ–±—É–≤—å',
        match: '–æ–¥–µ–∂–¥',
    },
]

function initFilter() {
    // just easy naive search by regular expression occurrence
    // could be substring search but reserved regular expression for complex queries
    let container = document.getElementById('filter-select')
    
    for (let type of filterOptions) {
        let label = document.createElement('label')
        label.style.display = 'block'
        
        let radio = document.createElement('input')
        radio.type = 'radio'
        radio.name = 'filter'
        radio.value = type.match
        radio.style.verticalAlign = 'text-top'
        radio.style.marginRight = '0.5em'
        radio.onchange = applyFilter
        
        label.appendChild(radio)
        label.appendChild(document.createTextNode(type.title))
        container.appendChild(label)
    }
    
    container.firstChild.firstChild.checked = true
    // using setTimeout because browsers sometimes remember the last choice
    setTimeout(() => container.firstChild.firstChild.checked = true, 0)
}

function applyFilter() {
    let match = this.value
    let regexp = match != '*' ? new RegExp(match, 'i') : null
    let count = 0
    
    let groupList = []
    
    map.closePopup()
    
    for (let p of places) {
        let matched = false
        
        if (regexp) {
            if (p.items) {
                for (let item of p.items) {
                    if (!item.disabled && regexp.test(item.title)) {
                        matched = true
                        break
                    }
                }
            }
        } else {
            matched = true
        }
        
        let marker = p._marker
        
        if (matched) {
            marker.addTo(map)
            // restore marker color
            marker._icon.classList.add('marker-' + p.type)
            groupList.push(marker)
            count++
        } else {
            marker.remove()
        }
    }
    
    // zoom markers into view
    let group = new L.featureGroup(groupList)
    map.fitBounds(group.getBounds())
    scrollToElement(document.getElementById('map-container'))
    
    // not used yet
    return count
}

initFilter()

</script>
</body>
</html>